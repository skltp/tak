<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<div class="nav" role="navigation" th:fragment="navigation-list">
    <ul>
        <li><a class="home" th:href="@{/}">Hem</a></li>
        <li><a class="create" th:href="@{${basePath} + '/create'}" th:text="'Skapa ' + ${entityName}"></a></li>
    </ul>
</div>

<div class="nav" role="navigation" th:fragment="navigation-show-edit">
    <ul>
        <li><a class="home" th:href="@{/}">Hem</a></li>
        <li><a class="list" th:href="@{${basePath}}" th:text="${entityName} + ' - Lista'"></a></li>
        <li><a class="create" th:href="@{${basePath} + '/create'}" th:text="'Skapa ' + ${entityName}"></a></li>
    </ul>
</div>

<div class="nav" role="navigation" th:fragment="navigation-create">
    <ul>
        <li><a class="home" th:href="@{/}">Hem</a></li>
        <li><a class="list" th:href="@{${basePath}}" th:text="${entityName} + ' - Lista'"></a></li>
    </ul>
</div>

<span th:fragment="chooseEntityIcon">
    <span th:if="${entity.isNewlyCreated()}">
        <img th:src="@{/static/images/created.png}" alt="Skapad"/>
    </span>
    <span th:if="${entity.isUpdatedAfterPublishedVersion()}">
        <img th:src="@{/static/images/updated.png}" alt="Uppdaterad"/>
    </span>
    <span th:if="${entity.getDeleted()}">
        <img th:src="@{/static/images/trash.png}" alt="Borttagen"/>
    </span>
</span>

<span th:fragment="listFilter">
    <form method="GET" th:action="@{${basePath}}" th:object="${list}">
        <fieldset>
            <span id="filters">
                <div th:each="filter, status : *{filters}">
                    <select name="filterField[]">
                        <option th:each="ffo : *{filterFieldOptions}"
                                th:value="${ffo.key}"
                                th:text="${ffo.value}"
                                th:selected="${ffo.key==filter.field}" >
                        </option>
                    </select>
                    <select name="filterCondition[]">
                        <option value="contains" th:selected="${filter.condition=='contains'}">Innehåller</option>
                        <option value="begins" th:selected="${filter.condition=='begins'}">Börjar med</option>
                        <option value="equals" th:selected="${filter.condition=='equals'}">Lika med</option>
                    </select>
                    <input type="text" maxlength="50" name="filterText[]" th:value="${filter.text}">
                    <input type="button" value="Ta bort" onclick="removeFilter(this)"/>
                </div>
            </span>
        </fieldset>
        <fieldset>
            <input type="button" value="Lägg till filter" onclick="addFilter()"/>
            <input type="submit" id="filterButton" value="Uppdatera"/>
        </fieldset>
    </form>
    <div id="newFilter" hidden>
        <select name="filterField[]">
            <option th:each="ffo : ${list.filterFieldOptions}"
                    th:value="${ffo.key}"
                    th:text="${ffo.value}">
            </option>
        </select>
        <select name="filterCondition[]">
            <option value="contains">Innehåller</option>
            <option value="begins">Börjar med</option>
            <option value="equals">Lika med</option>
        </select>
        <input type="text" maxlength="50" name="filterText[]">
        <input type="button" value="Ta bort" onclick="removeFilter(this)"/>
    </div>
    <script language="JavaScript">
    function addFilter() {
        let prototype = document.getElementById("newFilter");
        let copy = prototype.cloneNode(true);
        copy.removeAttribute("id");
        copy.removeAttribute("hidden");
        document.getElementById("filters").appendChild(copy);
    }

    function removeFilter(e) {
        e.parentNode.remove();
    }
    </script>
</span>

<div class="pagination" th:fragment="pagination">
    <th:block th:each="p,status : ${#numbers.sequence( 1, list.totalPages, 1)}">
        <th:block th:switch="${p}">
            <span th:case="${list.number}" class="currentStep" th:text="${p}"></span>
            <a th:case="1" th:href="@{${basePath}(offset=${list.max*(p-1)},max=${list.max})}" class="step"
               th:text="${p}"></a>
            <a th:case="${list.totalPages}" th:href="@{${basePath}(offset=${list.max*(p-1)},max=${list.max})}"
               class="step" th:text="${p}"></a>
            <span th:case="${list.number-5}" class="step gap">..</span>
            <span th:case="${list.number+5}" class="step gap">..</span>
            <a th:case="*" th:unless="${p < list.number-5 || p > list.number+5}"
               th:href="@{${basePath}(offset=${list.max*(p-1)},max=${list.max})}" class="step" th:text="${p}"></a>
        </th:block>
    </th:block>
</div>

<div th:if="${message != null}" th:fragment="message-banner">
    <span class="message" role="status" th:text="${message}"></span>
</div>

<ul th:if="${#fields.hasAnyErrors()}" class="errors" role="alert" th:fragment="errors-list">
    <li th:each="err : ${#fields.allErrors()}" th:text="${err}"></li>
</ul>


</html>